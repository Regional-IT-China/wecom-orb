description: |
  Notify a Wecom group with a custom message.
  The environment variables WECOM_ACCESS_TOKEN must be set for this orb to work.
  For instructions on how to set them, follow the setup guide available in the wiki: https://github.com/Regional-IT-China/wecom-orb/wiki/Setup.

parameters:
  step_name:
    type: string
    default: Wecom - Sending Notification
    description: Specify a custom step name for this command, if desired
steps:
  - run:
      when: on_fail
      name: Wecom - Detecting Job Status (FAIL)
      command: |
        echo 'export CCI_STATUS="fail"' > /tmp/WECOM_JOB_STATUS
  - run:
      when: on_success
      name: Wecom - Detecting Job Status (PASS)
      command: |
        echo 'export CCI_STATUS="pass"' > /tmp/WECOM_JOB_STATUS
  - run:
      when: always
      name: << parameters.step_name >>
      environment:
      command: <<include(scripts/main.sh)>>
